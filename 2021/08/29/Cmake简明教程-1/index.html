<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Cmake," />










<meta name="description" content="Cmake相关知识的简单介绍">
<meta property="og:type" content="article">
<meta property="og:title" content="Cmake简明教程">
<meta property="og:url" content="http://example.com/2021/08/29/Cmake%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B-1/index.html">
<meta property="og:site_name" content="爱吃桃的猴哥呀">
<meta property="og:description" content="Cmake相关知识的简单介绍">
<meta property="og:locale">
<meta property="og:image" content="c:%5CUsers%5CAdministrator%5CDesktop%5Cimage-20200730114931273.png">
<meta property="article:published_time" content="2021-08-29T14:11:56.000Z">
<meta property="article:modified_time" content="2021-08-29T14:13:42.121Z">
<meta property="article:author" content="nashpan">
<meta property="article:tag" content="Cmake">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:%5CUsers%5CAdministrator%5CDesktop%5Cimage-20200730114931273.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/2021/08/29/Cmake简明教程-1/"/>





  <title>Cmake简明教程 | 爱吃桃的猴哥呀</title>
  








<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">爱吃桃的猴哥呀</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">stand out, fit in</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/08/29/Cmake%E7%AE%80%E6%98%8E%E6%95%99%E7%A8%8B-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/rocky.webp">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="爱吃桃的猴哥呀">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Cmake简明教程</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-08-29T22:11:56+08:00">
                2021-08-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cmake/" itemprop="url" rel="index">
                    <span itemprop="name">Cmake</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Cmake相关知识的简单介绍</p>
<span id="more"></span>
<hr>
<h2 id="1-交叉编译-Cross-Compile">1. 交叉编译(Cross Compile)</h2>
<h3 id="1-1-什么是交叉编译">1.1 什么是交叉编译</h3>
<ul>
<li>**构建（build）：**构建 gcc 编译器的平台系统环境，编译该软件使用的平台。</li>
<li><strong>主机（host）</strong>：执行 gcc 编译器的平台系统环境，该软件运行的平台。</li>
<li>**目标（target）：**让 gcc 编译器产生能在什么格式运行的平台的系统环境，该软件处理的目标平台。<br>
build与host不同是交叉编译器；build与target不同是交叉编译链；三者都相同则为本地编译。例如：</li>
</ul>
<ol>
<li>指定：- -build=X86, - -host=X86, - -target=X86<br>
使用X86下构建X86的gcc编译器，编译出能在X86下运行的程序。</li>
<li>指定：- -build=X86, - -host=X86, - -target=MIPS<br>
在X86下交叉编译出能在MIPS下运行的可执行程序。</li>
<li>指定：- -build=X86, - -host=MIPS, - -target=X86<br>
在X86下构建 gcc交叉编译器，在MIPS上运行 gcc交叉编译器，编译出能在 ARM 上运行的可执行程序。</li>
</ol>
<h3 id="1-2-目标三元组（target-triple）">1.2 目标三元组（target triple）</h3>
<p>交叉编译过程中，为了唯一地表示各种不同对编译目标，将cpu 架构、供应商、操作系统和 ABI 相关信息组成目标三元组。<br>
目标三元组的基本格式为machine-vendor-os，<a target="_blank" rel="noopener" href="https://clang.llvm.org/docs/CrossCompilation.html">clang的标准目标三元组架构</a>为<code>&lt;arch&gt;&lt;sub&gt;-&lt;vendor&gt;-&lt;sys&gt;-&lt;abi&gt;</code></p>
<table>
<thead>
<tr>
<th>体系结构(arch)</th>
<th>厂商(vendor)</th>
<th>操作系统(sys)</th>
<th>环境(abi)</th>
</tr>
</thead>
<tbody>
<tr>
<td>arm,armeb,aarch64,<br>arc,x86,x86_64 等</td>
<td>unknown,apple,<br>pc,ibm,nvidia等</td>
<td>unknown,darwin,ios,<br>macosx,minw32,win32等</td>
<td>unknown,<br>gnu,gnux32,<br>android等</td>
</tr>
</tbody>
</table>
<p>上表为clang部分目标三元组。注意，并非所有对搭配都是有效的。例如macos的三元组为x86_64-apple-darwin。目标三元组可选择其中的1到个，clang会将其按一定对规则转换为标准格式。详细的目标三元组请参照<a target="_blank" rel="noopener" href="https://github.com/llvm/llvm-project/blob/master/llvm/include/llvm/ADT/Triple.h">LLVM的配置文件</a>。</p>
<h3 id="1-3-编译工具">1.3  编译工具</h3>
<p>在编译过程中，交叉编译器有GCC和CLANG两种，虽然也可以直接调用他们的命令将源代码一步一步地编译成库或者可执行文件，但是我们一般不这么做。现在主要对做法是利用其他工具包装整个编译过程，自动化地决定要编译哪些文件，定义哪些宏，选择编译配置等，最后生产一个编译器。<br>
常用的生成交叉编译器的工具有下面几种。</p>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="http://www.gnu.org/software/make/manual/make.html"><strong>Makefile</strong></a><br>
在软件开发中，make通常被视为一种软件构建工具。该工具主要经由读取一种名为“makefile”或“Makefile”的文件来实现软件的自动化建构。它会通过一种被称之为“target”概念来检查相关文件之间的依赖关系，这种依赖关系的检查系统非常简单，主要通过对比文件的修改时间来实现。在大多数情况下，我们主要用它来编译源代码，生成结果代码，然后把结果代码连接起来生成可执行文件或者库文件。<br>
现在我们很少去修改或者编写makeFile，需要了解的是他的一些命令。若需要详细了解makefile，可以查看<a target="_blank" rel="noopener" href="https://www.cnblogs.com/liangxiaxu/archive/2012/07/31/2617384.html">makefile中文手册</a>或<a target="_blank" rel="noopener" href="http://www.gnu.org/software/make/manual/make.html">官方文档</a>。</p>
<ul>
<li>make:编译库或可执行文件<br>
make命令执行时，需要一个 Makefile 文件，以告诉make命令需要怎么样的去编译和链接程序。</li>
<li>-C dir：指定makefile的路径<br>
例如：make –C ~hchen/test/prog</li>
<li>-h:打印帮助信息</li>
<li>-i:忽略编译过程中的所有错误</li>
<li>-I:指定一个被包含makefile的搜索目标。</li>
<li>-j:同时运行命令的个数。</li>
<li>-k:出错也不停止运行。如果生成一个目标失败了，那么依赖于其上的目标就不会被执行了。</li>
<li>(DESTDIR=path) install:安装编译好对库和头文件，可以指定安装路径，不指定则按makefile中的设定安装。<br>
例：make DESTDIR=/tmp/stage install</li>
</ul>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://ninja-build.org/manual.html"><strong>Ninja</strong></a><br>
Ninja是另一个构建系统。它以文件（通常是源代码和输出可执行文件）的相互依赖性为输入，并快速地构建它们。它适合编译小型代码，速度比make快。需要详细了解可以阅读<a target="_blank" rel="noopener" href="https://ninja-build.org/manual.html">Ninja的官方文档</a></p>
<ul>
<li>ninja: 编译目标，需要有.ninja文件</li>
<li>clean：清除构建文件</li>
<li>-h：打印帮助信息</li>
<li>-j：同时运行命令对个数</li>
<li>-k N 允许错误的目标个数</li>
</ul>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://help.apple.com/xcode/mac/current/"><strong>xcode</strong></a><br>
Xcode是苹果官方对开发工具，对IOS的交叉编译大部分都需要依赖它来进行。关于如何使用Xcode可以查看苹果对<a target="_blank" rel="noopener" href="https://help.apple.com/xcode/mac/current/">官方文档</a>。<br>
我交叉编译主要使用的是xcodebuild这个工具。关于xcodebuild的使用可以参考<a target="_blank" rel="noopener" href="https://www.dazhuanlan.com/2020/01/19/5e23410ad133b/">这篇教程</a>，写得比较清楚。下面介绍一下我用到的一些命令。</p>
<ul>
<li>-project  projectname : 	指定projectname</li>
<li>-target targetname: 指定targetname</li>
<li>-alltargets: 指定项目中的所有target</li>
<li>-configuration configurationname: 指定构建方式，Debug或者Release</li>
<li>-arch architecture: 指定架构</li>
<li>-sdk sdkname: 指定SDK,例如iphoneos13.5/iphoneossimulator13.5</li>
<li>-showsdks: 列出Xcode知道的所有可用SDK，包括适合使用的规范名称与-sdk。</li>
<li>-list: 列出项目中的目标和配置，或工作区中的方案。</li>
<li>clean: 在根目录执行clean操作。</li>
<li>build: 在根目录执行build操作</li>
<li>CONFIGURATION_BUILD_DIR=dir: 设置构建地址，这是直接设置环境变量。也可以使用DESTDIR<br>
下面是一些例子:</li>
<li>arm64架构，Release，ios真机:<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Release&#x27;  -sdk iphoneos13.5  CONFIGURATION_BUILD_DIR=&quot;$&#123;MY_CURRENT_BUILD_PATH&#125;&quot;  -arch arm64   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; clean build</span><br></pre></td></tr></table></figure>
</li>
<li>X86_64架构，DEBUG，ios模拟器:<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Debug&#x27;  -sdk iphonesimulator13.5  CONFIGURATION_BUILD_DIR=&quot;$&#123;MY_CURRENT_BUILD_PATH&#125;&quot;  -arch x86_64   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; clean build</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="2-Cmake">2. Cmake</h2>
<h3 id="2-1-Cmake简介">2.1 Cmake简介</h3>
<p>上面介绍的编译工具是生成编译器的工具，由于其要么对于大项目编写比较困难繁琐，要么跨平台的通用性不好，所以一般不直接使用，而是用一些其他工具生成它们。Cmake就是这样一个生成那些编译工具文件的工具。除了使用Cmake工具之外，一些库也会使用autoconf工具。</p>
<p>CMake是用于管理源代码构建的工具。最初，CMake被设计为多种方言的生成器<code>Makefile</code>，如今，CMake可以生成现代的构建系统<code>Ninja</code>，以及用于IDE（例如Visual Studio和Xcode）的项目文件。</p>
<p>CMake被广泛用于C和C ++语言，但是它也可以用于构建其他语言的源代码。现在已经拥有了庞大的功能体系和易用的GUI界面。本教程对其涉及得较浅，只是一个简单对入门。想要详细了解CMake,可以阅读他的<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/">官方文档</a>或者是<a target="_blank" rel="noopener" href="https://mubu.com/doc/t1VDCEn4O0">这篇比较详细的中文教程</a>。</p>
<h3 id="2-2-从几个简单的Cmake例子开始学习">2.2 从几个简单的Cmake例子开始学习</h3>
<p>下面从几个简单的例子开始学习Cmake（这只是对官方教程的简单翻译和改编，详细了解可直接阅读官方的[教程文档]([<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/guide/tutorial/index.html#guide:CMake%20Tutorial">https://cmake.org/cmake/help/v3.18/guide/tutorial/index.html#guide:CMake Tutorial</a>](<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/guide/tutorial/index.html#guide:CMake">https://cmake.org/cmake/help/v3.18/guide/tutorial/index.html#guide:CMake</a> Tutorial))）。</p>
<h4 id="2-2-1-编译一个简单的可执行文件">2.2.1 编译一个简单的可执行文件</h4>
<p>假设我们有只有一个c++文件tutorial.cxx，我们现在想把它编译为一个可执行文件。在MACOS中，步骤如下：</p>
<ol>
<li>
<p>在tutorial.cxx所在的文件夹下新建一个CMakeLists.txt，内容如下：</p>
 <figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#规定cmake的最低版本，若运行的camke版本低于次版本，会报错且提醒用户。</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.10</span>)</span><br><span class="line"><span class="comment"># 设置工程名</span></span><br><span class="line"><span class="keyword">project</span>(Tutorial)</span><br><span class="line"><span class="comment"># 添加可执行文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(Tutorial tutorial.cxx)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>打开苹果系统的终端，cd到当前文件夹，执行以下指令即可获得Tutorial.exe文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>可见，CMake编译的关键在于编写CMakeLists.txt文件。CMake支持大写，小写和大小写混合命令。所以上诉代码的命令部分大小写不敏感。</p>
<h4 id="2-2-2-添加同一文件夹多个文件及构建库">2.2.2 添加同一文件夹多个文件及构建库</h4>
<p>上面编译文件为可执行文件时，只使用了一个文件。使用多个文件时，可以在后面继续添加，但是，CMake提供了其他方法。如下所示：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#规定cmake的最低版本，若运行的camke版本低于次版本，会报错且提醒用户。</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.10</span>)</span><br><span class="line"><span class="comment"># 设置工程名</span></span><br><span class="line"><span class="keyword">project</span>(Tutorial)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置源文件</span></span><br><span class="line"><span class="keyword">set</span>(SOURCES</span><br><span class="line">  HelloWorld.cpp</span><br><span class="line">  HelloWorldIOS.mm</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置头文件</span></span><br><span class="line"><span class="keyword">set</span>(HEADERS</span><br><span class="line">  HelloWorld.hpp</span><br><span class="line">  HelloWorldIOS.h</span><br><span class="line">)</span><br><span class="line"><span class="comment">#添加静态库</span></span><br><span class="line"><span class="keyword">add_library</span> (Tutorial STATIC <span class="variable">$&#123;SOURCES&#125;</span> <span class="variable">$&#123;HEADERS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加可执行文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(Tutorial <span class="variable">$&#123;SOURCES&#125;</span> <span class="variable">$&#123;HEADERS&#125;</span>)</span><br></pre></td></tr></table></figure>
<p>如上所示，可将文件名（字符串）使用set放在特定的变量内，使用时利用${var}的方式读取变量。添加动态库使用add_library，详细将在之后解释。</p>
<p>除了这种枚举的方法，CMake还提供了自动遍历文件夹的方法。如下：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#规定cmake的最低版本，若运行的camke版本低于次版本，会报错且提醒用户。</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.10</span>)</span><br><span class="line"><span class="comment"># 设置工程名</span></span><br><span class="line"><span class="keyword">project</span>(Tutorial)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置源文件</span></span><br><span class="line"><span class="comment">#下面的方法会遍历当前文件夹下所有可用的文件</span></span><br><span class="line"><span class="comment"># aux_source_directories(. SOURCE)</span></span><br><span class="line"><span class="comment">#下面的方法用来遍历特定格式的文件</span></span><br><span class="line"><span class="keyword">FILE</span>(GLOB SOUREC <span class="string">&quot;*.cpp *.c *.m *.mm&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置头文件</span></span><br><span class="line"><span class="keyword">FILE</span>(GLOB HEADERS <span class="string">&quot;*.hpp *.h&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(HEADERS</span><br><span class="line">  HelloWorld.hpp</span><br><span class="line">  HelloWorldIOS.h</span><br><span class="line">)</span><br><span class="line"><span class="comment">#添加静态库</span></span><br><span class="line"><span class="keyword">add_library</span> (Tutorial STATIC <span class="variable">$&#123;SOURCES&#125;</span> <span class="variable">$&#123;HEADERS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加可执行文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(Tutorial <span class="variable">$&#123;SOURCES&#125;</span> <span class="variable">$&#123;HEADERS&#125;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="2-2-3-多个目录，多个源文件">2.2.3 多个目录，多个源文件</h4>
<p>假设我们的文件不在同一个文件夹下，比如MathUtils.h和MathUtils.c在math文件夹下，那么我们应当如下编写Cmakelists.txt。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#最顶层的文件</span></span><br><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.13</span>)</span><br><span class="line"><span class="keyword">project</span>(CMakeDemo C)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>(CMAKE_C_STANDARD <span class="number">99</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找当前目录下的所有源文件</span></span><br><span class="line"><span class="comment"># 并将名称保存到 DIR_SRCS 变量</span></span><br><span class="line"><span class="keyword">aux_source_directory</span>(. DIR_SRCS)</span><br><span class="line"><span class="comment"># 指定生成目标</span></span><br><span class="line"><span class="keyword">add_executable</span>(CMakeDemo <span class="variable">$&#123;DIR_SRCS&#125;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加 math 子目录</span></span><br><span class="line"><span class="keyword">add_subdirectory</span>(<span class="keyword">math</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加链接库</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(CMakeDemo MathUtils)</span><br></pre></td></tr></table></figure>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#math下的文件</span></span><br><span class="line"><span class="comment"># 查找当前目录下的所有源文件</span></span><br><span class="line"><span class="comment"># 并将名称保存到 DIR_LIB_SRCS 变量</span></span><br><span class="line"><span class="keyword">aux_source_directory</span>(. DIR_LIB_SRCS)</span><br><span class="line"><span class="comment"># 指定生成 MathUtils 链接库</span></span><br><span class="line"><span class="keyword">add_library</span> (MathUtils <span class="variable">$&#123;DIR_LIB_SRCS&#125;</span>)<span class="comment">#命令 add_library 将 src 目录中的源文件编译为静态链接库。</span></span><br></pre></td></tr></table></figure>
<h4 id="2-2-4-连接第三方库">2.2.4 连接第三方库</h4>
<p>若需要连接第三方库，以为CURL例，代码如下：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#寻找CURL库</span></span><br><span class="line"><span class="keyword">find_package</span>(CURL)</span><br><span class="line"><span class="comment">#添加可执行文件</span></span><br><span class="line"><span class="keyword">add_executable</span>(curltest curltest.cc)</span><br><span class="line"><span class="comment">#关联头文件</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(clib PRIVATE <span class="variable">$&#123;CURL_INCLUDE_DIR&#125;</span>)</span><br><span class="line"><span class="comment">#关联库文件</span></span><br><span class="line"><span class="keyword">target_link_libraries</span>(curltest <span class="variable">$&#123;CURL_LIBRARY&#125;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>关于find_package，在之后进行说明。</p>
<h3 id="2-3-CMake的过程控制">2.3 CMake的过程控制</h3>
<p>通过上面的学习我们已经基本掌握了CMake的大致流程。要掌握Cmake，还需要掌握的是它的过程控制，命令以及缓存变量。</p>
<p>CMake和其他语言一样，有它的分支控制和循环控制。</p>
<h4 id="2-3-1-条件语句">2.3.1 条件语句</h4>
<p>Cmake的条件语句基本语法如下：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(&lt;condition&gt;)</span><br><span class="line">  &lt;commands&gt;</span><br><span class="line"><span class="keyword">elseif</span>(&lt;condition&gt;) <span class="comment"># optional block, can be repeated</span></span><br><span class="line">  &lt;commands&gt;</span><br><span class="line"><span class="keyword">else</span>()              <span class="comment"># optional block</span></span><br><span class="line">  &lt;commands&gt;</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>
<p>它的条件控制和其他语言区别不大，下面是一个简单的例子：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&quot;option&quot;用来定义宏，&quot;ON&quot;表示打开，&quot;OFF&quot;表示关闭</span></span><br><span class="line"><span class="keyword">option</span> (BUILD_SHARED <span class="string">&quot;Use tutorial provided math implementation&quot;</span> <span class="keyword">OFF</span>)</span><br><span class="line"><span class="comment"># 若BUILD_SHARED为ON</span></span><br><span class="line"><span class="keyword">if</span>(BUILD_SHARED)</span><br><span class="line"><span class="comment">#建立动态库</span></span><br><span class="line">  <span class="keyword">add_library</span> (example SHARED <span class="variable">$&#123;SOURCES&#125;</span> <span class="variable">$&#123;HEADERS&#125;</span>)</span><br><span class="line">  <span class="keyword">message</span>(STATUS <span class="string">&quot;Building shared version...&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line"><span class="comment">#建立静态库</span></span><br><span class="line">  <span class="keyword">add_library</span> (example STATIC <span class="variable">$&#123;SOURCES&#125;</span> <span class="variable">$&#123;HEADERS&#125;</span>)</span><br><span class="line">  <span class="keyword">message</span>(STATUS <span class="string">&quot;Building static version...&quot;</span>)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>
<p>上面的例子进行了一个简单的分支控制。若想建立动态库，执行命令时将BUILD_SHARED设置为ON即可。设置方法为：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake -DBUILD_SHARED=ON</span><br></pre></td></tr></table></figure>
<h4 id="2-3-2-循环控制">2.3.2 循环控制</h4>
<p>Cmake的循环控制主要有两种，也是比较好理解的类型。</p>
<p>下面是while型。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(&lt;condition&gt;)</span><br><span class="line">  &lt;commands&gt;</span><br><span class="line"><span class="keyword">endwhile</span>()</span><br></pre></td></tr></table></figure>
<p>下面是foreach型，它有几种变形形式</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(&lt;loop_var&gt; &lt;items&gt;)</span><br><span class="line">  &lt;commands&gt;</span><br><span class="line"><span class="keyword">endforeach</span>()</span><br></pre></td></tr></table></figure>
<p>下面是它的例子。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(i <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;current is $&#123;i&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>(i)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;end&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>(i)</span><br><span class="line"><span class="comment">#运行结果</span></span><br><span class="line"></span><br><span class="line">-- current is <span class="number">0</span></span><br><span class="line">-- current is <span class="number">1</span></span><br><span class="line">-- current is <span class="number">2</span></span><br><span class="line">-- current is <span class="number">3</span></span><br><span class="line">-- end</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>即遍历第二到最后一个参数。</p>
<p>第二种：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(&lt;loop_var&gt; RANGE &lt;stop&gt;)</span><br><span class="line"><span class="comment">#例</span></span><br><span class="line"><span class="keyword">foreach</span>(i RANGE <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;current is $&#123;i&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>(i)</span><br><span class="line"><span class="comment">#运行结果</span></span><br><span class="line"></span><br><span class="line">-- current is <span class="number">0</span></span><br><span class="line">-- current is <span class="number">1</span></span><br><span class="line">-- current is <span class="number">2</span></span><br><span class="line">-- current is <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(&lt;loop_var&gt; RANGE &lt;start&gt; &lt;stop&gt; [&lt;step&gt;])</span><br><span class="line"><span class="comment">#例</span></span><br><span class="line"><span class="keyword">foreach</span>(i RANGE <span class="number">3</span> <span class="number">9</span> <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;current is $&#123;i&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>(i)</span><br><span class="line"><span class="comment">#运行结果</span></span><br><span class="line"></span><br><span class="line">-- current is <span class="number">3</span></span><br><span class="line">-- current is <span class="number">5</span></span><br><span class="line">-- current is <span class="number">7</span></span><br><span class="line">-- current is <span class="number">9</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>第三种：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(&lt;loop_var&gt; IN [LISTS [&lt;lists&gt;]] [ITEMS [&lt;items&gt;]])</span><br><span class="line"><span class="comment">#例</span></span><br><span class="line"><span class="keyword">set</span>(A <span class="number">0</span>;<span class="number">1</span>)</span><br><span class="line"><span class="keyword">set</span>(B <span class="number">2</span> <span class="number">3</span>)</span><br><span class="line"><span class="keyword">set</span>(C <span class="string">&quot;4 5&quot;</span>)</span><br><span class="line"><span class="keyword">set</span>(D <span class="number">6</span>;<span class="number">7</span> <span class="number">8</span>)</span><br><span class="line"><span class="keyword">set</span>(E <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">foreach</span>(X IN LISTS A B C D E)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;X=$&#123;X&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">#运行结果</span></span><br><span class="line">-- X=<span class="number">0</span></span><br><span class="line">-- X=<span class="number">1</span></span><br><span class="line">-- X=<span class="number">2</span></span><br><span class="line">-- X=<span class="number">3</span></span><br><span class="line">-- X=<span class="number">4</span> <span class="number">5</span></span><br><span class="line">-- X=<span class="number">6</span></span><br><span class="line">-- X=<span class="number">7</span></span><br><span class="line">-- X=<span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>第四种</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span>(&lt;loop_var&gt;... IN ZIP_LISTS &lt;lists&gt;)</span><br><span class="line"><span class="comment">#例</span></span><br><span class="line"><span class="keyword">list</span>(APPEND English one two three four)</span><br><span class="line"><span class="keyword">list</span>(APPEND Bahasa satu dua tiga)</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(num IN ZIP_LISTS English Bahasa)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;num_0=$&#123;num_0&#125;, num_1=$&#123;num_1&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(en ba IN ZIP_LISTS English Bahasa)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;en=$&#123;en&#125;, ba=$&#123;ba&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">endforeach</span>()</span><br><span class="line"><span class="comment">#运行结果</span></span><br><span class="line">-- num_0=one, num_1=satu</span><br><span class="line">-- num_0=two, num_1=dua</span><br><span class="line">-- num_0=three, num_1=tiga</span><br><span class="line">-- num_0=four, num_1=</span><br><span class="line">-- en=one, ba=satu</span><br><span class="line">-- en=two, ba=dua</span><br><span class="line">-- en=three, ba=tiga</span><br><span class="line">-- en=four, ba=</span><br></pre></td></tr></table></figure>
<p>在if和循环中，break和continue的用法基本与c一样，放心使用。</p>
<h3 id="2-4-Cmake的函数、宏和模块">2.4 Cmake的函数、宏和模块</h3>
<h4 id="2-4-1-函数">2.4.1 函数</h4>
<p>Cmake的函数定义如下：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>(&lt;name&gt; [&lt;arg1&gt; ...])</span><br><span class="line">  &lt;commands&gt;</span><br><span class="line"><span class="keyword">endfunction</span>()</span><br></pre></td></tr></table></figure>
<p>定义了函数之后，在函数体内可以使用几个特别的其它变量，它们的说明如下。</p>
<table>
<thead>
<tr>
<th>变量</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ARGV#</td>
<td>ARGV0为第一个参数，ARGV1为第二个参数，依次类推</td>
</tr>
<tr>
<td>ARGV</td>
<td>定义宏（函数）时参数为2个，实际传了4个，则ARGV代表实际传入的两个</td>
</tr>
<tr>
<td>ARGN</td>
<td>定义宏（函数）时参数为2个，实际传了4个，则ARGN代表剩下的两个</td>
</tr>
<tr>
<td>ARGC</td>
<td>实际传入的参数的个数</td>
</tr>
</tbody>
</table>
<p>下面是一个简单的例子。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义函数</span></span><br><span class="line"><span class="keyword">Function</span>(myfunction ag1 ag2 ag3)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;function ag is &quot;</span> <span class="variable">$&#123;ag1&#125;</span>)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;function ag is &quot;</span> <span class="variable">$&#123;ag2&#125;</span>)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;function ag is &quot;</span> <span class="variable">$&#123;ag3&#125;</span>)</span><br><span class="line"><span class="keyword">endfunction</span>(myfunction)</span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line">myfunction(<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">-- <span class="keyword">function</span> ag is <span class="number">1</span></span><br><span class="line">-- <span class="keyword">function</span> ag is <span class="number">2</span></span><br><span class="line">-- <span class="keyword">function</span> ag is <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>下面是；另一个简单的例子。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义函数</span></span><br><span class="line"><span class="keyword">function</span>(_func)</span><br><span class="line">  <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in func __func &quot;</span> <span class="variable">$&#123;ARGN&#125;</span>)</span><br><span class="line">  <span class="keyword">if</span>(ARGV0)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in a 1 &quot;</span> <span class="variable">$&#123;ARGV0&#125;</span>)</span><br><span class="line">  <span class="keyword">endif</span>()</span><br><span class="line">  <span class="keyword">foreach</span>(arg IN LISTS ARGN)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in __func 2 $&#123;arg&#125;&quot;</span>)</span><br><span class="line">  <span class="keyword">endforeach</span>()</span><br><span class="line"><span class="keyword">endfunction</span>(_func)</span><br><span class="line"><span class="comment">#调用函数</span></span><br><span class="line">_func(d e f)</span><br><span class="line"><span class="comment">#运行结果</span></span><br><span class="line">-- this is in func __func def</span><br><span class="line">-- this is in a <span class="number">2</span> d</span><br><span class="line">-- this is in __func <span class="number">2</span> d</span><br><span class="line">-- this is in __func <span class="number">2</span> e</span><br><span class="line">-- this is in __func <span class="number">2</span> f</span><br></pre></td></tr></table></figure>
<p>另外函数可以用return()将控制权返回给上级，之后会停止执行函数的代码。注意return()并不能返回任何值。由于函数参数的传递都是引用传递，函数要返回值，一般通过修改传入参数的方式。</p>
<h4 id="2-4-2-宏">2.4.2 宏</h4>
<p>cmake宏定义macro和函数function几乎没有什么区别。当然，事实上macro和c语言中一样，只是一种代码的替换，所以它定义的变量并不是真正意义上的变量，所以，在使用上会有一些差别。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#宏的定义</span></span><br><span class="line"><span class="keyword">macro</span>(&lt;name&gt; [&lt;arg1&gt; ...])</span><br><span class="line">  &lt;commands&gt;</span><br><span class="line"><span class="keyword">endmacro</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义宏</span></span><br><span class="line"><span class="keyword">macro</span>(mymacro ag1 ag2 ag3)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;macro ag is &quot;</span> <span class="variable">$&#123;ag1&#125;</span>)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;macro ag is &quot;</span> <span class="variable">$&#123;ag2&#125;</span>)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;macro ag is &quot;</span> <span class="variable">$&#123;ag3&#125;</span>)</span><br><span class="line"><span class="comment"># 调用宏</span></span><br><span class="line">mymacro(<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span>)</span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">-- <span class="keyword">macro</span> ag is <span class="number">1</span></span><br><span class="line">-- <span class="keyword">macro</span> ag is <span class="number">2</span></span><br><span class="line">-- <span class="keyword">macro</span> ag is <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义宏</span></span><br><span class="line"><span class="keyword">macro</span>(_bar)</span><br><span class="line">  <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in macro bar &quot;</span> <span class="variable">$&#123;ARGN&#125;</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">set</span>(aa <span class="variable">$&#123;ARGV0&#125;</span>)</span><br><span class="line">  <span class="keyword">if</span>(ARGV0)</span><br><span class="line">     <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in a 1&quot;</span>)</span><br><span class="line">  <span class="keyword">endif</span>()</span><br><span class="line">    <span class="keyword">if</span>(aa)</span><br><span class="line">  <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in a 2 &quot;</span> <span class="variable">$&#123;aa&#125;</span>)</span><br><span class="line">  <span class="keyword">endif</span>()</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">set</span>(list_var <span class="variable">$&#123;ARGN&#125;</span>)</span><br><span class="line">  <span class="keyword">foreach</span>(arg IN LISTS ARGN)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in macro 2 $&#123;arg&#125;&quot;</span>)</span><br><span class="line">  <span class="keyword">endforeach</span>()</span><br><span class="line">  <span class="keyword">foreach</span>(arg <span class="variable">$&#123;ARGN&#125;</span>)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in macro 3 $&#123;arg&#125;&quot;</span>)</span><br><span class="line">  <span class="keyword">endforeach</span>()</span><br><span class="line">  <span class="keyword">foreach</span>(arg IN LISTS list_var)</span><br><span class="line">    <span class="keyword">message</span>(STATUS <span class="string">&quot;this is in macro 4 $&#123;arg&#125;&quot;</span>)</span><br><span class="line">  <span class="keyword">endforeach</span>()</span><br><span class="line"><span class="keyword">endmacro</span>(_bar)</span><br><span class="line"><span class="comment">#调用宏</span></span><br><span class="line">_bar(a b c)</span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">-- this is in <span class="keyword">macro</span> bar abc</span><br><span class="line">-- this is in a <span class="number">2</span> a</span><br><span class="line">-- this is in <span class="keyword">macro</span> <span class="number">3</span> a</span><br><span class="line">-- this is in <span class="keyword">macro</span> <span class="number">3</span> b</span><br><span class="line">-- this is in <span class="keyword">macro</span> <span class="number">3</span> c</span><br><span class="line">-- this is in <span class="keyword">macro</span> <span class="number">4</span> a</span><br><span class="line">-- this is in <span class="keyword">macro</span> <span class="number">4</span> b</span><br><span class="line">-- this is in <span class="keyword">macro</span> <span class="number">4</span> c</span><br></pre></td></tr></table></figure>
<p>上面的最后一个例子展示了宏里面的变量并不是真正的变量，在if和foreach中并不起作用。</p>
<p>另外和函数的另一个区别是它没法用return()把控制权返回给上级。</p>
<h4 id="2-4-3-模块">2.4.3 模块</h4>
<p>cmake能够识别CMakeLists.txt文件和xxx.cmake结尾的文件，模块就是以xxx.cmake结尾的文件，可以理解为，将一些通用的函数功能封装到到一个指定的文件中，然后通过include(xxx.cmake)方式引用，这样可以达到代码复用的目的。模块既可以被CMakeLists.txt引用，也可以被其它模块引用。</p>
<p>cmake系统本身内置了一些预定义的模块可以供我们使用，比如FindCURL模块，它的使用方式是通过FIND_PACKAGE指令来完成的。</p>
<p>下面是一个例子。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#cmake/myfunction.cmake文件中</span></span><br><span class="line"><span class="comment"># 定义函数</span></span><br><span class="line"><span class="keyword">Function</span>(myfunction ag1 ag2 ag3)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;function ag is &quot;</span> <span class="variable">$&#123;ag1&#125;</span>)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;function ag is &quot;</span> <span class="variable">$&#123;ag2&#125;</span>)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="string">&quot;function ag is &quot;</span> <span class="variable">$&#123;ag3&#125;</span>)</span><br><span class="line"><span class="keyword">endfunction</span>(myfunction)</span><br><span class="line"></span><br><span class="line"><span class="comment">#CMakeLists.txt文件中</span></span><br><span class="line"><span class="comment">#包含方法一</span></span><br><span class="line"><span class="keyword">list</span>(APPEND CMAKE_MODULE_PATH <span class="string">&quot;$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;/cmake&quot;</span>)</span><br><span class="line"><span class="keyword">include</span>(myfunction)</span><br><span class="line"></span><br><span class="line"><span class="comment">#包含方法二</span></span><br><span class="line"><span class="keyword">include</span>(cmake/myfunction.cmake)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line">myfunction(<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果</span></span><br><span class="line">-- <span class="keyword">function</span> ag is <span class="number">1</span></span><br><span class="line">-- <span class="keyword">function</span> ag is <span class="number">2</span></span><br><span class="line">-- <span class="keyword">function</span> ag is <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h3 id="2-5-脚本命令（Scripting-Commands）">2.5 脚本命令（Scripting Commands）</h3>
<p>下面介绍一些除了过程控制和函数相关的脚本命令之外比较常用的脚本命令。</p>
<ul>
<li>cmake_host_system_information：查询运行cmake的主机系统的系统信息。用处比较多，具体可参考<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/cmake_host_system_information.html">官方文档</a>。</li>
<li>cmake_minimum_required：设置项目的cmake最低要求版本。</li>
<li>cmake_policy：管理CMake策略设置。即指定可能的新版本的CMake按照老的方式运行。</li>
<li>execute_process：运行给定序列的一个或多个命令。命令作为管道并发执行，每个进程的标准输出通过管道传递到下一个进程的标准输入。单个标准错误管道用于所有过程。</li>
<li>file：文件操作，比较复杂，可参见<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/file.html">官方文档</a>。主要的命令如下：</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Reading</span><br><span class="line">  <span class="keyword">file</span>(READ &lt;filename&gt; &lt;out-var&gt; [...])</span><br><span class="line">  <span class="keyword">file</span>(STRINGS &lt;filename&gt; &lt;out-var&gt; [...])</span><br><span class="line">  <span class="keyword">file</span>(&lt;HASH&gt; &lt;filename&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">file</span>(TIMESTAMP &lt;filename&gt; &lt;out-var&gt; [...])</span><br><span class="line">  <span class="keyword">file</span>(GET_RUNTIME_DEPENDENCIES [...])</span><br><span class="line"></span><br><span class="line">Writing</span><br><span class="line">  <span class="keyword">file</span>(&#123;WRITE | APPEND&#125; &lt;filename&gt; &lt;content&gt;...)</span><br><span class="line">  <span class="keyword">file</span>(&#123;TOUCH | TOUCH_NOCREATE&#125; [&lt;<span class="keyword">file</span>&gt;...])</span><br><span class="line">  <span class="keyword">file</span>(GENERATE OUTPUT &lt;output-<span class="keyword">file</span>&gt; [...])</span><br><span class="line">  <span class="keyword">file</span>(CONFIGURE OUTPUT &lt;output-<span class="keyword">file</span>&gt; CONTENT &lt;content&gt; [...])</span><br><span class="line"></span><br><span class="line">Filesystem</span><br><span class="line">  <span class="keyword">file</span>(&#123;GLOB | GLOB_RECURSE&#125; &lt;out-var&gt; [...] [&lt;globbing-expr&gt;...])</span><br><span class="line">  <span class="keyword">file</span>(RENAME &lt;oldname&gt; &lt;newname&gt;)</span><br><span class="line">  <span class="keyword">file</span>(&#123;<span class="keyword">REMOVE</span> | REMOVE_RECURSE &#125; [&lt;files&gt;...])</span><br><span class="line">  <span class="keyword">file</span>(<span class="keyword">MAKE_DIRECTORY</span> [&lt;dir&gt;...])</span><br><span class="line">  <span class="keyword">file</span>(&#123;COPY | <span class="keyword">INSTALL</span>&#125; &lt;<span class="keyword">file</span>&gt;... DESTINATION &lt;dir&gt; [...])</span><br><span class="line">  <span class="keyword">file</span>(SIZE &lt;filename&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">file</span>(READ_SYMLINK &lt;linkname&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">file</span>(CREATE_LINK &lt;original&gt; &lt;linkname&gt; [...])</span><br><span class="line"></span><br><span class="line">Path Conversion</span><br><span class="line">  <span class="keyword">file</span>(RELATIVE_PATH &lt;out-var&gt; &lt;directory&gt; &lt;<span class="keyword">file</span>&gt;)</span><br><span class="line">  <span class="keyword">file</span>(&#123;TO_CMAKE_PATH | TO_NATIVE_PATH&#125; &lt;path&gt; &lt;out-var&gt;)</span><br><span class="line"></span><br><span class="line">Transfer</span><br><span class="line">  <span class="keyword">file</span>(DOWNLOAD &lt;url&gt; &lt;<span class="keyword">file</span>&gt; [...])</span><br><span class="line">  <span class="keyword">file</span>(UPLOAD &lt;<span class="keyword">file</span>&gt; &lt;url&gt; [...])</span><br><span class="line"></span><br><span class="line">Locking</span><br><span class="line">  <span class="keyword">file</span>(LOCK &lt;path&gt; [...])</span><br><span class="line"></span><br><span class="line">Archiving</span><br><span class="line">  <span class="keyword">file</span>(ARCHIVE_CREATE OUTPUT &lt;archive&gt; PATHS &lt;paths&gt;... [...])</span><br><span class="line">  <span class="keyword">file</span>(ARCHIVE_EXTRACT INPUT &lt;archive&gt; [...])</span><br></pre></td></tr></table></figure>
<p>比较常用的是系统文件操作，例如file({GLOB | GLOB_RECURSE} <out-var> […] [<globbing-expr>…])用来遍历文件，GLOB_RECURSE还可以递归查找。</p>
<ul>
<li>
<p>find_file (<VAR> name1 [path1 path2 …])：用于查找文件，查找到的完整路径会存在var中。</p>
</li>
<li>
<p>find_library (<VAR> name1 [path1 path2 …])：查找库文件</p>
</li>
<li>
<p>find_package：引入外部依赖包。这是一个比较复杂但好用的功能。关于他的使用和搜索规则可以参加<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/find_package.html">官方文档</a>。简单地说这是用来按照一定的规则搜索依赖包的，不用我们自己指定。一般安装在/usr下或者是根目录下的三方依赖包都能找到，还可以设置他的搜索路径来帮助搜索。</p>
</li>
<li>
<p>find_path：查找路径或文件夹。</p>
</li>
<li>
<p>find_program：查找可执行文件。</p>
</li>
<li>
<p>list：列表操作。由于list是CMake的一个很重要的数据类型，所以这个命令很有用，具体的用法参见<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/list.html">官方文档</a>。它的定义如下，由于list与数组类似，它的操作都比较容易懂。</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Reading</span><br><span class="line">  <span class="keyword">list</span>(LENGTH &lt;<span class="keyword">list</span>&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">list</span>(GET &lt;<span class="keyword">list</span>&gt; &lt;element index&gt; [&lt;index&gt; ...] &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">list</span>(JOIN &lt;<span class="keyword">list</span>&gt; &lt;glue&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">list</span>(SUBLIST &lt;<span class="keyword">list</span>&gt; &lt;begin&gt; &lt;length&gt; &lt;out-var&gt;)</span><br><span class="line"></span><br><span class="line">Search</span><br><span class="line">  <span class="keyword">list</span>(FIND &lt;<span class="keyword">list</span>&gt; &lt;value&gt; &lt;out-var&gt;)</span><br><span class="line"></span><br><span class="line">Modification</span><br><span class="line">  <span class="keyword">list</span>(APPEND &lt;<span class="keyword">list</span>&gt; [&lt;element&gt;...])</span><br><span class="line">  <span class="keyword">list</span>(FILTER &lt;<span class="keyword">list</span>&gt; &#123;<span class="keyword">INCLUDE</span> | EXCLUDE&#125; REGEX &lt;regex&gt;)</span><br><span class="line">  <span class="keyword">list</span>(INSERT &lt;<span class="keyword">list</span>&gt; &lt;index&gt; [&lt;element&gt;...])</span><br><span class="line">  <span class="keyword">list</span>(POP_BACK &lt;<span class="keyword">list</span>&gt; [&lt;out-var&gt;...])</span><br><span class="line">  <span class="keyword">list</span>(POP_FRONT &lt;<span class="keyword">list</span>&gt; [&lt;out-var&gt;...])</span><br><span class="line">  <span class="keyword">list</span>(PREPEND &lt;<span class="keyword">list</span>&gt; [&lt;element&gt;...])</span><br><span class="line">  <span class="keyword">list</span>(REMOVE_ITEM &lt;<span class="keyword">list</span>&gt; &lt;value&gt;...)</span><br><span class="line">  <span class="keyword">list</span>(REMOVE_AT &lt;<span class="keyword">list</span>&gt; &lt;index&gt;...)</span><br><span class="line">  <span class="keyword">list</span>(REMOVE_DUPLICATES &lt;<span class="keyword">list</span>&gt;)</span><br><span class="line">  <span class="keyword">list</span>(TRANSFORM &lt;<span class="keyword">list</span>&gt; &lt;ACTION&gt; [...])</span><br><span class="line"></span><br><span class="line">Ordering</span><br><span class="line">  <span class="keyword">list</span>(REVERSE &lt;<span class="keyword">list</span>&gt;)</span><br><span class="line">  <span class="keyword">list</span>(SORT &lt;<span class="keyword">list</span>&gt; [...])</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>message：打印信息，Cmake的主要交互手段。</p>
</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">General messages</span><br><span class="line">  <span class="keyword">message</span>([&lt;mode&gt;] <span class="string">&quot;message text&quot;</span> ...)</span><br><span class="line"></span><br><span class="line">Reporting checks</span><br><span class="line">  <span class="keyword">message</span>(&lt;checkState&gt; <span class="string">&quot;message text&quot;</span> ...)</span><br><span class="line">  <span class="comment">#其中mode选项为</span></span><br><span class="line">  (无) = 重要消息；</span><br><span class="line"> STATUS = 非重要消息；</span><br><span class="line"> WARNING = CMake 警告, 会继续执行；</span><br><span class="line"> AUTHOR_WARNING = CMake 警告 (dev), 会继续执行；</span><br><span class="line"> SEND_ERROR = CMake 错误, 继续执行，但是会跳过生成的步骤；</span><br><span class="line"> FATAL_ERROR = CMake 错误, 终止所有处理过程；</span><br></pre></td></tr></table></figure>
<ul>
<li>option(<variable> “&lt;help_text&gt;” [value])：提供用户可以选择选择的选项，ON表示打开，OFF表示关闭。</li>
<li>set：设置变量。将普通变量，缓存变量或环境变量设置为给定值。</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置普通变量</span></span><br><span class="line"><span class="keyword">set</span>(&lt;variable&gt; &lt;value&gt;... [PARENT_SCOPE])</span><br><span class="line"><span class="comment">#设置缓存变量</span></span><br><span class="line"><span class="keyword">set</span>(&lt;variable&gt; &lt;value&gt;... CACHE &lt;type&gt; &lt;docstring&gt; [FORCE])</span><br><span class="line"><span class="comment">#设置环境变量</span></span><br><span class="line"><span class="keyword">set</span>(ENV&#123;&lt;variable&gt;&#125; [&lt;value&gt;])</span><br></pre></td></tr></table></figure>
<ul>
<li>set_property :在范围的零个或多个对象上设置一个属性。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">set_property(&lt;GLOBAL                      |</span><br><span class="line">              DIRECTORY [&lt;dir&gt;]           |</span><br><span class="line">              TARGET    [&lt;target1&gt; ...]   |</span><br><span class="line">              SOURCE    [&lt;src1&gt; ...]</span><br><span class="line">                        [DIRECTORY &lt;dirs&gt; ...] |</span><br><span class="line">                        [TARGET_DIRECTORY &lt;targets&gt; ...]</span><br><span class="line">              INSTALL   [&lt;file1&gt; ...]     |</span><br><span class="line">              TEST      [&lt;test1&gt; ...]     |</span><br><span class="line">              CACHE     [&lt;entry1&gt; ...]    &gt;</span><br><span class="line">             [APPEND] [APPEND_STRING]</span><br><span class="line">             PROPERTY &lt;name&gt; [&lt;value1&gt; ...])</span><br></pre></td></tr></table></figure>
<ul>
<li>string：字符串操作，也是比较常用的指令。</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Search <span class="keyword">and</span> Replace</span><br><span class="line">  <span class="keyword">string</span>(FIND &lt;<span class="keyword">string</span>&gt; &lt;substring&gt; &lt;out-var&gt; [...])</span><br><span class="line">  <span class="keyword">string</span>(REPLACE &lt;match-<span class="keyword">string</span>&gt; &lt;replace-<span class="keyword">string</span>&gt; &lt;out-var&gt; &lt;input&gt;...)</span><br><span class="line">  <span class="keyword">string</span>(REGEX MATCH &lt;match-regex&gt; &lt;out-var&gt; &lt;input&gt;...)</span><br><span class="line">  <span class="keyword">string</span>(REGEX MATCHALL &lt;match-regex&gt; &lt;out-var&gt; &lt;input&gt;...)</span><br><span class="line">  <span class="keyword">string</span>(REGEX REPLACE &lt;match-regex&gt; &lt;replace-expr&gt; &lt;out-var&gt; &lt;input&gt;...)</span><br><span class="line"></span><br><span class="line">Manipulation</span><br><span class="line">  <span class="keyword">string</span>(APPEND &lt;<span class="keyword">string</span>-var&gt; [&lt;input&gt;...])</span><br><span class="line">  <span class="keyword">string</span>(PREPEND &lt;<span class="keyword">string</span>-var&gt; [&lt;input&gt;...])</span><br><span class="line">  <span class="keyword">string</span>(CONCAT &lt;out-var&gt; [&lt;input&gt;...])</span><br><span class="line">  <span class="keyword">string</span>(JOIN &lt;glue&gt; &lt;out-var&gt; [&lt;input&gt;...])</span><br><span class="line">  <span class="keyword">string</span>(TOLOWER &lt;<span class="keyword">string</span>&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(TOUPPER &lt;<span class="keyword">string</span>&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(LENGTH &lt;<span class="keyword">string</span>&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(SUBSTRING &lt;<span class="keyword">string</span>&gt; &lt;begin&gt; &lt;length&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(STRIP &lt;<span class="keyword">string</span>&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(GENEX_STRIP &lt;<span class="keyword">string</span>&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(REPEAT &lt;<span class="keyword">string</span>&gt; &lt;count&gt; &lt;out-var&gt;)</span><br><span class="line"></span><br><span class="line">Comparison</span><br><span class="line">  <span class="keyword">string</span>(COMPARE &lt;op&gt; &lt;string1&gt; &lt;string2&gt; &lt;out-var&gt;)</span><br><span class="line"></span><br><span class="line">Hashing</span><br><span class="line">  <span class="keyword">string</span>(&lt;HASH&gt; &lt;out-var&gt; &lt;input&gt;)</span><br><span class="line"></span><br><span class="line">Generation</span><br><span class="line">  <span class="keyword">string</span>(ASCII &lt;number&gt;... &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(HEX &lt;<span class="keyword">string</span>&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(CONFIGURE &lt;<span class="keyword">string</span>&gt; &lt;out-var&gt; [...])</span><br><span class="line">  <span class="keyword">string</span>(MAKE_C_IDENTIFIER &lt;<span class="keyword">string</span>&gt; &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(RANDOM [&lt;<span class="keyword">option</span>&gt;...] &lt;out-var&gt;)</span><br><span class="line">  <span class="keyword">string</span>(TIMESTAMP &lt;out-var&gt; [&lt;format <span class="keyword">string</span>&gt;] [UTC])</span><br><span class="line">  <span class="keyword">string</span>(UUID &lt;out-var&gt; ...)</span><br></pre></td></tr></table></figure>
<ul>
<li>unset: 取消设置变量，缓存变量或环境变量。</li>
<li>variable_watch(<variable> [<command>])：监听变量，执行操作。</li>
</ul>
<h3 id="2-6-工程命令（Project-Commands）">2.6 工程命令（Project Commands）</h3>
<ul>
<li>add_compile_options：添加编译参数。</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (MSVC)</span><br><span class="line">    <span class="comment"># warning level 4 and all warnings as errors</span></span><br><span class="line">    <span class="keyword">add_compile_options</span>(/W4 /WX)</span><br><span class="line"><span class="keyword">else</span>()</span><br><span class="line">    <span class="comment"># lots of warnings and all warnings as errors</span></span><br><span class="line">    <span class="keyword">add_compile_options</span>(-Wall -Wextra -pedantic -Werror)</span><br><span class="line"><span class="keyword">endif</span>()</span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_custom_target.html">add_custom_target</a>：添加一个没有输出的目标，一般用来测试依赖或指令。</li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_definitions.html">add_definitions</a>：添加预处理宏定义，编译参数或者头文件包含等选项。</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_definitions</span>(-DFOO -DBAR ...)</span><br><span class="line">注意 此命令已被替代：</span><br><span class="line">用 <span class="keyword">add_compile_definitions</span>() 添加预处理器定义。</span><br><span class="line"></span><br><span class="line">用 <span class="keyword">include_directories</span>() 添加包含目录。</span><br><span class="line"></span><br><span class="line">用 <span class="keyword">add_compile_options</span>() 添加其他选项。</span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_dependencies.html">add_dependencies</a>:使顶层<code>&lt;target&gt;</code>依赖于其他顶层目标，以确保它们先于其他目标进行构建<code>&lt;target&gt;</code>。顶级目标是由以下目标之一创建的目标:<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_executable.html#command:add_executable"><code>add_executable()</code></a>， <a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_library.html#command:add_library"><code>add_library()</code></a>， <a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_custom_target.html#command:add_custom_target"><code>add_custom_target()</code></a>命令（但不是CMake生成的目标，如<code>install</code>）。</li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_executable.html">add_executable</a>:添加可执行文件。</li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_library.html">add_library</a>：添加库。一般语法如下：</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_library</span>(&lt;name&gt; [STATIC | SHARED | MODULE]</span><br><span class="line">            [EXCLUDE_FROM_ALL]</span><br><span class="line">            [source1] [source2 ...])</span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_link_options.html">add_link_options</a>：为之后的链接命令添加选项。</li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/add_link_options.html">add_link_options</a>：</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_subdirectory</span>(source_dir [binary_dir] [EXCLUDE_FROM_ALL])</span><br><span class="line"><span class="comment">#向构建添加一个子目录。source_dir指定源CMakeLists.txt和代码文件所在的目录。如果是相对路径，则将相对于当前目录（典型用法）进行评估，但也可能是绝对路径</span></span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/aux_source_directory.html">aux_source_directory</a>:在目录中查找所有源文件。</li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/include_directories.html">include_directories</a>:将给定目录添加到编译器用于搜索头文件的目录中。相对路径被解释为相对于当前源目录。注意，会对所有的目标起作用。</li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/install.html">install</a>：指定在安装时运行的规则。</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">install</span>(TARGETS &lt;<span class="keyword">target</span>&gt;... [...])</span><br><span class="line"><span class="keyword">install</span>(&#123;FILES | PROGRAMS&#125; &lt;<span class="keyword">file</span>&gt;... [...])</span><br><span class="line"><span class="keyword">install</span>(DIRECTORY &lt;dir&gt;... [...])</span><br><span class="line"><span class="keyword">install</span>(SCRIPT &lt;<span class="keyword">file</span>&gt; [...])</span><br><span class="line"><span class="keyword">install</span>(CODE &lt;code&gt; [...])</span><br><span class="line"><span class="keyword">install</span>(<span class="keyword">EXPORT</span> &lt;<span class="keyword">export</span>-name&gt; [...])</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/link_directories.html">link_directories</a>：链接库目录，注意参数是一个文件夹目录，会链接该文件夹下的所有库文件。</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/link_libraries.html">link_libraries</a>：链接库文件，参数是一个库文件的路径。</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/project.html">project</a>：设置工程名称。</p>
</li>
</ul>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">project</span>(&lt;<span class="keyword">PROJECT</span>-NAME&gt; [&lt;language-name&gt;...])</span><br><span class="line"><span class="keyword">project</span>(&lt;<span class="keyword">PROJECT</span>-NAME&gt;</span><br><span class="line">        [VERSION &lt;major&gt;[.&lt;minor&gt;[.&lt;patch&gt;[.&lt;tweak&gt;]]]]</span><br><span class="line">        [DESCRIPTION &lt;<span class="keyword">project</span>-description-<span class="keyword">string</span>&gt;]</span><br><span class="line">        [HOMEPAGE_URL &lt;url-<span class="keyword">string</span>&gt;]</span><br><span class="line">        [LANGUAGES &lt;language-name&gt;...])</span><br><span class="line">        </span><br><span class="line"><span class="comment">#名字会存放到PROJECT_NAME，顶层的还会存到CMAKE_PROJECT_NAME。源文件路径存到PROJECT_SOURCE_DIR, &lt;PROJECT-NAME&gt;_SOURCE_DIR，构建路径存放到PROJECT_BINARY_DIR, &lt;PROJECT-NAME&gt;_BINARY_DIR。        </span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/remove_definitions.html">remove_definitions</a>：取消宏定义。</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/target_include_directories.html">target_include_directories</a>：添加头文件目录，与<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/link_libraries.html">link_libraries</a>的区别在于它只会针对指定目标，而后者会针对所有目标。</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/target_link_directories.html">target_link_directories</a>：链接库目录，与<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/link_libraries.html">link_libraries</a>的区别在于它只会针对指定目标，而后者会针对所有目标。</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/target_link_libraries.html">target_link_libraries</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/command/target_link_options.html">target_link_options</a></p>
</li>
</ul>
<h3 id="2-7-变量">2.7 变量</h3>
<p>CMake的变量是比较重要的一部分内容。除了用户自己定义的普通变量之外，CMake还有操作系统的环境变量和CMake预定义的缓存变量。环境变量所有CMake都可以访问到，可以在shell界面直接设置，Cmake定义了一些环境变量如下。</p>
<h4 id="2-7-1-环境变量">2.7.1 环境变量</h4>
<h5 id="2-7-1-1-控制构建的环境变量">2.7.1.1 控制构建的环境变量</h5>
<ul>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CMAKE_CONFIG_TYPE.html">CMAKE_CONFIG_TYPE</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CMAKE_GENERATOR.html">CMAKE_GENERATOR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CMAKE_GENERATOR_INSTANCE.html">CMAKE_GENERATOR_INSTANCE</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CMAKE_GENERATOR_PLATFORM.html">CMAKE_GENERATOR_PLATFORM</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CMAKE_GENERATOR_TOOLSET.html">CMAKE_GENERATOR_TOOLSET</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CMAKE_OSX_ARCHITECTURES.html">CMAKE_OSX_ARCHITECTURES</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/DESTDIR.html">DESTDIR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/LDFLAGS.html">LDFLAGS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/MACOSX_DEPLOYMENT_TARGET.html">MACOSX_DEPLOYMENT_TARGET</a></li>
</ul>
<h5 id="2-7-1-2-语言相关环境变量">2.7.1.2 语言相关环境变量</h5>
<ul>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/ASM_DIALECT.html">ASM</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/ASM_DIALECTFLAGS.html">ASMFLAGS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CC.html">CC</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CFLAGS.html">CFLAGS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CSFLAGS.html">CSFLAGS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CUDACXX.html">CUDACXX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CUDAFLAGS.html">CUDAFLAGS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CUDAHOSTCXX.html">CUDAHOSTCXX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CXX.html">CXX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/CXXFLAGS.html">CXXFLAGS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/FC.html">FC</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/FFLAGS.html">FFLAGS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/OBJC.html">OBJC</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/OBJCXX.html">OBJCXX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/RC.html">RC</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/RCFLAGS.html">RCFLAGS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/envvar/SWIFTC.html">SWIFTC</a></li>
</ul>
<h4 id="2-7-2-缓存变量">2.7.2 缓存变量</h4>
<h5 id="2-7-2-1-提供信息类">2.7.2.1 提供信息类</h5>
<ul>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_ARGC.html">CMAKE_ARGC</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_ARGV0.html">CMAKE_ARGV0</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_BINARY_DIR.html">CMAKE_BINARY_DIR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_BUILD_TOOL.html">CMAKE_BUILD_TOOL</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_CROSSCOMPILING.html">CMAKE_CROSSCOMPILING</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_CROSSCOMPILING_EMULATOR.html">CMAKE_CROSSCOMPILING_EMULATOR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_CURRENT_BINARY_DIR.html">CMAKE_CURRENT_BINARY_DIR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_CURRENT_SOURCE_DIR.html">CMAKE_CURRENT_SOURCE_DIR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_DL_LIBS.html">CMAKE_DL_LIBS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_EXECUTABLE_SUFFIX.html">CMAKE_EXECUTABLE_SUFFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_EXTRA_SHARED_LIBRARY_SUFFIXES.html">CMAKE_EXTRA_SHARED_LIBRARY_SUFFIXES</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_LANG_COMPILER_AR.html">CMAKE__COMPILER_AR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_LANG_COMPILER_RANLIB.html">CMAKE__COMPILER_RANLIB</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_LANG_LINK_LIBRARY_SUFFIX.html">CMAKE__LINK_LIBRARY_SUFFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_LINK_LIBRARY_SUFFIX.html">CMAKE_LINK_LIBRARY_SUFFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_MINIMUM_REQUIRED_VERSION.html">CMAKE_MINIMUM_REQUIRED_VERSION</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_MINOR_VERSION.html">CMAKE_MINOR_VERSION</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_PROJECT_DESCRIPTION.html">CMAKE_PROJECT_DESCRIPTION</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_PROJECT_HOMEPAGE_URL.html">CMAKE_PROJECT_HOMEPAGE_URL</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_PROJECT_NAME.html">CMAKE_PROJECT_NAME</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_SHARED_LIBRARY_PREFIX.html">CMAKE_SHARED_LIBRARY_PREFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_SHARED_LIBRARY_SUFFIX.html">CMAKE_SHARED_LIBRARY_SUFFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_SOURCE_DIR.html">CMAKE_SOURCE_DIR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_STATIC_LIBRARY_PREFIX.html">CMAKE_STATIC_LIBRARY_PREFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_STATIC_LIBRARY_SUFFIX.html">CMAKE_STATIC_LIBRARY_SUFFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_TOOLCHAIN_FILE.html">CMAKE_TOOLCHAIN_FILE</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_XCODE_GENERATE_SCHEME.html">CMAKE_XCODE_GENERATE_SCHEME</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_XCODE_PLATFORM_TOOLSET.html">CMAKE_XCODE_PLATFORM_TOOLSET</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/PROJECT-NAME_BINARY_DIR.html">_BINARY_DIR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/PROJECT-NAME_DESCRIPTION.html">_DESCRIPTION</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/PROJECT-NAME_SOURCE_DIR.html">_SOURCE_DIR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/PROJECT_BINARY_DIR.html">PROJECT_BINARY_DIR</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/PROJECT_DESCRIPTION.html">PROJECT_DESCRIPTION</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/PROJECT_NAME.html">PROJECT_NAME</a></li>
</ul>
<h5 id="2-7-2-2-影响行为类">2.7.2.2 影响行为类</h5>
<ul>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/BUILD_SHARED_LIBS.html">BUILD_SHARED_LIBS</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_BUILD_TYPE.html">CMAKE_BUILD_TYPE</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_CONFIGURATION_TYPES.html">CMAKE_CONFIGURATION_TYPES</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_DISABLE_FIND_PACKAGE_PackageName.html">CMAKE_DISABLE_FIND_PACKAGE_</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_FIND_FRAMEWORK.html">CMAKE_FIND_FRAMEWORK</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_FIND_LIBRARY_CUSTOM_LIB_SUFFIX.html">CMAKE_FIND_LIBRARY_CUSTOM_LIB_SUFFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_FIND_LIBRARY_PREFIXES.html">CMAKE_FIND_LIBRARY_PREFIXES</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_FIND_LIBRARY_SUFFIXES.html">CMAKE_FIND_LIBRARY_SUFFIXES</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_FRAMEWORK_PATH.html">CMAKE_FRAMEWORK_PATH</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_IGNORE_PATH.html">CMAKE_IGNORE_PATH</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_INCLUDE_PATH.html">CMAKE_INCLUDE_PATH</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_INSTALL_PREFIX.html">CMAKE_INSTALL_PREFIX</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_LIBRARY_PATH.html">CMAKE_LIBRARY_PATH</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_PREFIX_PATH.html">CMAKE_PREFIX_PATH</a></li>
<li><a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/variable/CMAKE_SYSROOT.html">CMAKE_SYSROOT</a></li>
</ul>
<h2 id="2-8-CMAKE命令行工具">2.8 CMAKE命令行工具</h2>
<ul>
<li>-s：指定源文件路径</li>
<li>-B：指定构建目录</li>
<li>-D：设置缓存变量</li>
<li>-U：取消设置缓存变量</li>
<li>-G：指定生成器，可选有Ninja，Xcode，Unix Makefiles(默认)等。</li>
<li>-h 打印帮助文档。</li>
</ul>
<h2 id="3-IOS的交叉编译">3.IOS的交叉编译</h2>
<p>IOS的交叉编译一般都是使用CMake生成Xcode工程，然后使用Xcode编译相应的文件。关于这一点，<a target="_blank" rel="noopener" href="https://cmake.org/cmake/help/v3.18/manual/cmake-toolchains.7.html#cross-compiling-for-ios-tvos-or-watchos">Cmake的官网有说明</a>。</p>
<p>一般地，使用下面的代码即可解决大多数拥有CMakelists.txt的交叉编译问题。当然，由于需要用到一个交叉编译链工具，所以将它们打包成为了一个文件夹来使用。</p>
<p><img src="C:%5CUsers%5CAdministrator%5CDesktop%5Cimage-20200730114931273.png" alt="image-20200730114931273"></p>
<p>使用方法如下：</p>
<p>1.将libMakeKit文件夹复制到源文件根目录<br>
<a target="_blank" rel="noopener" href="http://2.xn--build-lu5iy95tmt1a.sh">2.编辑好build.sh</a> 和 CMakeLists.txt<br>
3.打开终端<br>
4.运行’‘‘cd libMakeKit’’’ 转到libMakeKit文件夹<br>
5.运行’‘‘sh ./build.sh’’’ 等待编译完成<br>
6.静态库存放于lib文件夹下</p>
<p>需要修改的内容一般是将TEST,EXAMPLE,SHARED等选项设为OFF，指定相应的头文件或者是库文件路径等。例如</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmake ../.. -G Xcode -DCMAKE_TOOLCHAIN_FILE=../ios.toolchain.cmake -DPLATFORM=OS64COMBINED -DBUILD_TEST=OFF -DGFLAGS_LIBRARY=/USR/Local</span><br></pre></td></tr></table></figure>
<p>当然，某些复杂的或者是没有对IOS系统进行适配好对第三方库，需要屏蔽CMake的一些检测，一些依赖甚至需要修改源代码。llvm甚至需要使用Ninja进行编译。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 作者:xiaohai.huang</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 介绍：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个脚本全部自动化编译各指令集静态库后合并。现在支持指令集有arm64 arm64e x86_64</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 目前主要是64位手机,32位的手机几乎已经过时了,可以不用考虑</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意：此脚本是编译iOS平台的库</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> </span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用：</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  首先<span class="built_in">cd</span> 到xcode工程目录 然后运行 <span class="string">&quot;sh ./build.sh&quot;</span></span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> </span></span><br><span class="line"><span class="meta">#</span><span class="bash">可用-project projectname的方式指定工程名称，否则会自动搜寻build目录</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">激活cmake指令</span></span><br><span class="line">source ~/.bash_profile</span><br><span class="line">echo cmake指令激活完成</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">PROJECT_NAME=<span class="string">&quot;gflags&quot;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">创建xcode工程</span></span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line"><span class="meta">#</span><span class="bash">生成XCode工程，一般的设置在这儿进行。</span></span><br><span class="line">cmake ../.. -G Xcode -DCMAKE_TOOLCHAIN_FILE=../ios.toolchain.cmake -DPLATFORM=OS64COMBINED</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">输入project名</span></span><br><span class="line">if [[ $1 == &quot;-project&quot; ]];then</span><br><span class="line">	PROJECT_NAME=$2</span><br><span class="line">fi</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">若未指定工程名，自动扫描</span></span><br><span class="line">if [ ! $PROJECT_NAME ];then</span><br><span class="line">	paths=`ls .`</span><br><span class="line">	for file in $paths </span><br><span class="line">	do</span><br><span class="line">		if [[ $file == *&quot;.xcodeproj&quot; ]]; then</span><br><span class="line">			end=$&#123;#file&#125;-10</span><br><span class="line">			PROJECT_NAME=$&#123;file:0:end&#125;</span><br><span class="line">			echo 找到工程$PROJECT_NAME</span><br><span class="line">			break</span><br><span class="line"><span class="meta">			#</span><span class="bash">statements</span></span><br><span class="line">		fi</span><br><span class="line"><span class="meta">		#</span><span class="bash">statements</span></span><br><span class="line">	done</span><br><span class="line">fi</span><br><span class="line">if [ $PROJECT_NAME ];then</span><br><span class="line"><span class="meta">	#</span><span class="bash">工程的名字</span> </span><br><span class="line">	MY_PROJECT_NAME=&quot;$&#123;PROJECT_NAME&#125;.xcodeproj&quot;</span><br><span class="line">else</span><br><span class="line">	echo 没有找到xcode工程</span><br><span class="line">	exit 0</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">curPath=`pwd`</span><br><span class="line">if [ ! -e &quot;$&#123;MY_PROJECT_NAME&#125;&quot; ]; then</span><br><span class="line">  echo $&#123;curPath&#125;/$&#123;MY_PROJECT_NAME&#125;文件不存在</span><br><span class="line">  exit 0</span><br><span class="line">fi</span><br><span class="line"><span class="meta">#</span><span class="bash"> arm64 arm64e</span></span><br><span class="line"></span><br><span class="line">MY_ARM64_BUILD_PATH=&quot;$&#123;curPath&#125;/../lib/Release/arm64&quot;</span><br><span class="line">MY_CURRENT_BUILD_PATH=&quot;$&#123;MY_ARM64_BUILD_PATH&#125;&quot;</span><br><span class="line"></span><br><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Release&#x27;  -sdk iphoneos13.5  CONFIGURATION_BUILD_DIR=&quot;$&#123;MY_CURRENT_BUILD_PATH&#125;&quot;  -arch arm64   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; clean build</span><br><span class="line"></span><br><span class="line">MY_ARM64E_BUILD_PATH=&quot;$&#123;curPath&#125;/../lib/Release/armv64e&quot;</span><br><span class="line">MY_CURRENT_BUILD_PATH=&quot;$&#123;MY_ARM64E_BUILD_PATH&#125;&quot;</span><br><span class="line"></span><br><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Release&#x27;  -sdk iphoneos13.5  CONFIGURATION_BUILD_DIR=&quot;$&#123;MY_CURRENT_BUILD_PATH&#125;&quot;  -arch arm64e   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; clean build</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> x86_64</span> </span><br><span class="line"></span><br><span class="line">MY_X86_64_BUILD_PATH=&quot;$&#123;curPath&#125;/../lib/Release/x86_64&quot;</span><br><span class="line">MY_CURRENT_BUILD_PATH=&quot;$&#123;MY_X86_64_BUILD_PATH&#125;&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">安装到usr</span></span><br><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Release&#x27;  -sdk iphonesimulator13.5  -arch x86_64   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; clean build</span><br><span class="line"></span><br><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Release&#x27;  -sdk iphonesimulator13.5  CONFIGURATION_BUILD_DIR=&quot;$&#123;MY_CURRENT_BUILD_PATH&#125;&quot;  -arch x86_64   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; build</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> DEBUG</span></span><br><span class="line">MY_ARM64_BUILD_PATH=&quot;$&#123;curPath&#125;/../lib/Debug/arm64&quot;</span><br><span class="line">MY_CURRENT_BUILD_PATH=&quot;$&#123;MY_ARM64_BUILD_PATH&#125;&quot;</span><br><span class="line"></span><br><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Debug&#x27;  -sdk iphoneos13.5  CONFIGURATION_BUILD_DIR=&quot;$&#123;MY_CURRENT_BUILD_PATH&#125;&quot;  -arch arm64   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; clean build</span><br><span class="line"></span><br><span class="line">MY_ARM64E_BUILD_PATH=&quot;$&#123;curPath&#125;/../lib/Debug/armv64e&quot;</span><br><span class="line">MY_CURRENT_BUILD_PATH=&quot;$&#123;MY_ARM64E_BUILD_PATH&#125;&quot;</span><br><span class="line"></span><br><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Debug&#x27;  -sdk iphoneos13.5  CONFIGURATION_BUILD_DIR=&quot;$&#123;MY_CURRENT_BUILD_PATH&#125;&quot;  -arch arm64e   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; clean build</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> x86_64</span></span><br><span class="line"></span><br><span class="line">MY_X86_64_BUILD_PATH=&quot;$&#123;curPath&#125;/../lib/Debug/x86_64&quot;</span><br><span class="line">MY_CURRENT_BUILD_PATH=&quot;$&#123;MY_X86_64_BUILD_PATH&#125;&quot;</span><br><span class="line"></span><br><span class="line">xcodebuild -project &quot;$&#123;MY_PROJECT_NAME&#125;&quot; -alltargets -configuration &#x27;Debug&#x27;  -sdk iphonesimulator13.5  CONFIGURATION_BUILD_DIR=&quot;$&#123;MY_CURRENT_BUILD_PATH&#125;&quot;  -arch x86_64   IPHONEOS_DEPLOYMENT_TARGET=&#x27;8.0&#x27; clean build</span><br><span class="line"></span><br><span class="line">echo 编译完成</span><br><span class="line">cd ..</span><br><span class="line">curPath=`pwd`</span><br><span class="line">echo 静态库放在$&#123;curPath&#125;/lib下</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######在此已经编译完成了</span></span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Cmake/" rel="tag"># Cmake</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/08/22/C-%E5%9F%BA%E7%A1%80/" rel="next" title="C++基础">
                <i class="fa fa-chevron-left"></i> C++基础
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/09/04/shader-noise/" rel="prev" title="shader noise">
                shader noise <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/rocky.webp"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91-Cross-Compile"><span class="nav-number">1.</span> <span class="nav-text">1. 交叉编译(Cross Compile)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 什么是交叉编译</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E7%9B%AE%E6%A0%87%E4%B8%89%E5%85%83%E7%BB%84%EF%BC%88target-triple%EF%BC%89"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 目标三元组（target triple）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7"><span class="nav-number">1.3.</span> <span class="nav-text">1.3  编译工具</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Cmake"><span class="nav-number">2.</span> <span class="nav-text">2. Cmake</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Cmake%E7%AE%80%E4%BB%8B"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 Cmake简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E4%BB%8E%E5%87%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84Cmake%E4%BE%8B%E5%AD%90%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 从几个简单的Cmake例子开始学习</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-%E7%BC%96%E8%AF%91%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.2.1 编译一个简单的可执行文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2-%E6%B7%BB%E5%8A%A0%E5%90%8C%E4%B8%80%E6%96%87%E4%BB%B6%E5%A4%B9%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6%E5%8F%8A%E6%9E%84%E5%BB%BA%E5%BA%93"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2.2 添加同一文件夹多个文件及构建库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-3-%E5%A4%9A%E4%B8%AA%E7%9B%AE%E5%BD%95%EF%BC%8C%E5%A4%9A%E4%B8%AA%E6%BA%90%E6%96%87%E4%BB%B6"><span class="nav-number">2.2.3.</span> <span class="nav-text">2.2.3 多个目录，多个源文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-4-%E8%BF%9E%E6%8E%A5%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="nav-number">2.2.4.</span> <span class="nav-text">2.2.4 连接第三方库</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-CMake%E7%9A%84%E8%BF%87%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 CMake的过程控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5"><span class="nav-number">2.3.1.</span> <span class="nav-text">2.3.1 条件语句</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-%E5%BE%AA%E7%8E%AF%E6%8E%A7%E5%88%B6"><span class="nav-number">2.3.2.</span> <span class="nav-text">2.3.2 循环控制</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Cmake%E7%9A%84%E5%87%BD%E6%95%B0%E3%80%81%E5%AE%8F%E5%92%8C%E6%A8%A1%E5%9D%97"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 Cmake的函数、宏和模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-%E5%87%BD%E6%95%B0"><span class="nav-number">2.4.1.</span> <span class="nav-text">2.4.1 函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-%E5%AE%8F"><span class="nav-number">2.4.2.</span> <span class="nav-text">2.4.2 宏</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-3-%E6%A8%A1%E5%9D%97"><span class="nav-number">2.4.3.</span> <span class="nav-text">2.4.3 模块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4%EF%BC%88Scripting-Commands%EF%BC%89"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 脚本命令（Scripting Commands）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-%E5%B7%A5%E7%A8%8B%E5%91%BD%E4%BB%A4%EF%BC%88Project-Commands%EF%BC%89"><span class="nav-number">2.6.</span> <span class="nav-text">2.6 工程命令（Project Commands）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-%E5%8F%98%E9%87%8F"><span class="nav-number">2.7.</span> <span class="nav-text">2.7 变量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-1-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">2.7.1.</span> <span class="nav-text">2.7.1 环境变量</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-1-1-%E6%8E%A7%E5%88%B6%E6%9E%84%E5%BB%BA%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">2.7.1.1.</span> <span class="nav-text">2.7.1.1 控制构建的环境变量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-1-2-%E8%AF%AD%E8%A8%80%E7%9B%B8%E5%85%B3%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">2.7.1.2.</span> <span class="nav-text">2.7.1.2 语言相关环境变量</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-7-2-%E7%BC%93%E5%AD%98%E5%8F%98%E9%87%8F"><span class="nav-number">2.7.2.</span> <span class="nav-text">2.7.2 缓存变量</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-2-1-%E6%8F%90%E4%BE%9B%E4%BF%A1%E6%81%AF%E7%B1%BB"><span class="nav-number">2.7.2.1.</span> <span class="nav-text">2.7.2.1 提供信息类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-7-2-2-%E5%BD%B1%E5%93%8D%E8%A1%8C%E4%B8%BA%E7%B1%BB"><span class="nav-number">2.7.2.2.</span> <span class="nav-text">2.7.2.2 影响行为类</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-8-CMAKE%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7"><span class="nav-number">3.</span> <span class="nav-text">2.8 CMAKE命令行工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-IOS%E7%9A%84%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91"><span class="nav-number">4.</span> <span class="nav-text">3.IOS的交叉编译</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">nashpan</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
